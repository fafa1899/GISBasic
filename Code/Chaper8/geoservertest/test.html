<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>test handle response</title>
  <script>
    var url = "http://localhost:8080/geoserver/wfs";
    var xhr = new XMLHttpRequest();
    xhr.open("POST", url);
    xhr.setRequestHeader("Content-Type", "text/xml");
    xhr.onload = function (e) {
      if (xhr.readyState === 4) {
        if (xhr.status === 200) {
          console.log(xhr.responseText);
        } else {
          console.error(xhr.statusText);
        }
      }
    };

    xhr.onerror = function (e) {
      console.error(xhr.statusText);
    };

    //查询
    var xml = `<?xml version='1.0' encoding='UTF-8'?>
<wfs:GetFeature service=\"WFS\" version=\"2.0.0\" outputFormat=\"json\" 
xmlns:wfs=\"http://www.opengis.net/wfs/2.0\" 
xmlns:fes=\"http://www.opengis.net/fes/2.0\" 
xmlns:gml=\"http://www.opengis.net/gml/3.2\" 
xmlns:test=\"https://test\" 
xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" 
xsi:schemaLocation=\"http://www.opengis.net/wfs/2.0 
http://schemas.opengis.net/wfs/2.0/wfs.xsd 
http://www.opengis.net/gml/3.2 
http://schemas.opengis.net/gml/3.2.1/gml.xsd\">
  <wfs:Query typeNames='test:multipolygons'>
    <fes:Filter>
      <fes:Intersects>
        <fes:ValueReference>test:the_geom</fes:ValueReference>
        <gml:Envelope srsName=\"EPSG:4326\">
          <gml:lowerCorner>
            -77.039412232917 38.8954267799311
          </gml:lowerCorner>
          <gml:upperCorner>
            -77.0380063000187 38.8965224165805
          </gml:upperCorner>
        </gml:Envelope>
      </fes:Intersects>
    </fes:Filter>
  </wfs:Query>
</wfs:GetFeature>`;
    //插入   
    /* 
    var xml = 
"<?xml version=\"1.0\"?>"+
"<wfs:Transaction service=\"WFS\" version=\"2.0.0\" "+
"xmlns:test=\"https://test\" "+
"xmlns:fes=\"http://www.opengis.net/fes/2.0\" "+
"xmlns:gml=\"http://www.opengis.net/gml/3.2\" "+
"xmlns:wfs=\"http://www.opengis.net/wfs/2.0\" "+
"xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" "+
"xsi:schemaLocation=\"http://www.opengis.net/wfs/2.0 "+
"http://schemas.opengis.net/wfs/2.0/wfs.xsd "+
"http://www.opengis.net/gml/3.2 "+
"http://schemas.opengis.net/gml/3.2.1/gml.xsd\">"+
"<wfs:Insert>"+
"<test:multipolygons gml:id=\"multipolygons.351\">"+
  "<test:the_geom>"+
    "<gml:MultiSurface srsName=\"http://www.opengis.net/gml/srs/epsg.xml#4326\" srsDimension=\"2\" gml:id=\"multipolygons.352.the_geom\">"+
    "<gml:surfaceMember>"+
    "<gml:Polygon gml:id=\"multipolygons.351.the_geom.1\">"+
          "<gml:exterior>"+
    "<gml:LinearRing>"+
              "<gml:posList>-77.039412232917 38.8954267799311 -77.039412232917 38.8965224165805 -77.0380063000187 38.8965224165805 -77.0380063000187 38.8954267799311 -77.039412232917 38.8954267799311</gml:posList>"+
            "</gml:LinearRing>"+
    "</gml:exterior>"+                         
    "</gml:Polygon>"+
      "</gml:surfaceMember>"+
    "</gml:MultiSurface>"+
  "</test:the_geom>"+     
"</test:multipolygons>"+
"</wfs:Insert>"+   
"</wfs:Transaction>"; */
    //删除    
    /*
    var xml = `<?xml version='1.0' encoding='UTF-8'?>
<wfs:Transaction version="2.0.0" service="WFS"
   xmlns:fes="http://www.opengis.net/fes/2.0"
   xmlns:wfs="http://www.opengis.net/wfs/2.0"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.opengis.net/wfs/2.0
                       http://schemas.opengis.net/wfs/2.0/wfs.xsd">
   <wfs:Delete typeName="test:multipolygons">
      <fes:Filter>
         <fes:ResourceId rid="multipolygons.351"/>
      </fes:Filter>
   </wfs:Delete>
</wfs:Transaction>`*/
    //替换   
    /*
    var xml = `<?xml version='1.0' encoding='UTF-8'?>
<wfs:Transaction version="2.0.0" service="WFS"
    xmlns:test="https://test"
    xmlns:fes="http://www.opengis.net/fes/2.0"
    xmlns:wfs="http://www.opengis.net/wfs/2.0"
    xmlns:gml="http://www.opengis.net/gml/3.2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.opengis.net/wfs/2.0
			http://schemas.opengis.net/wfs/2.0/wfs.xsd">
  <wfs:Replace> 
    <test:multipolygons gml:id="multipolygons.351">
      <test:the_geom>
        <gml:MultiSurface srsName="http://www.opengis.net/gml/srs/epsg.xml#4326" srsDimension="2" gml:id="multipolygons.352.the_geom">
          <gml:surfaceMember>
            <gml:Polygon gml:id="multipolygons.351.the_geom.1">
              <gml:exterior>
                <gml:LinearRing>
                  <gml:posList>-77.039412232917 38.8954267799311 -77.039412232917 38.8965224165805 -77.0380063000187 38.8965224165805 -77.039412232917 38.8954267799311
                  </gml:posList>
                </gml:LinearRing>
              </gml:exterior>                         
            </gml:Polygon>
          </gml:surfaceMember>
        </gml:MultiSurface>   
      </test:the_geom>
    </test:multipolygons>
    <fes:Filter>
      <fes:ResourceId rid="multipolygons.351"/>
    </fes:Filter>
  </wfs:Replace>
</wfs:Transaction>`*/
    //更新    
    /*
    var xml = `<?xml version='1.0' encoding='UTF-8'?>
<wfs:Transaction version="2.0.0" service="WFS"
   xmlns:fes="http://www.opengis.net/fes/2.0"
   xmlns:wfs="http://www.opengis.net/wfs/2.0"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.opengis.net/wfs/2.0
                       http://schemas.opengis.net/wfs/2.0.0/wfs.xsd">
   <wfs:Update typeName="test:multipolygons">
      <wfs:Property>
         <wfs:ValueReference>name</wfs:ValueReference>
         <wfs:Value>bound</wfs:Value>
      </wfs:Property>
      <wfs:Property>
         <wfs:ValueReference>other_tags</wfs:ValueReference>
         <wfs:Value>test</wfs:Value>
      </wfs:Property>      
      <fes:Filter>
         <fes:ResourceId rid="multipolygons.351"/>
      </fes:Filter>
   </wfs:Update>
</wfs:Transaction>`*/
    xhr.send(xml);
  </script>
</head>

<body>

</body>

</html>